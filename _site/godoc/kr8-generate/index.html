<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Iceberg Tech" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>kr8 generate - kr8+ Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "kr8 generate";
        var mkdocs_page_input_path = "godoc/kr8-generate.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> kr8+ Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../README-repo/">Repo Readme</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/ice-bergtech/kr8-examples">Examples ðŸ”—</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Concepts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/clusters/">Clusters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/nativefuncs/">Native Funcs</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Cmd Docs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8/">kr8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_version/">kr8 version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_generate/">kr8 generate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_format/">kr8 format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 get</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get/">kr8 get</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_clusters/">kr8 get clusters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_components/">kr8 get components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_params/">kr8 get params</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 init</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init/">kr8 init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_cluster/">kr8 init cluster</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_component/">kr8 init component</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_repo/">kr8 init repo</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 jsonnet</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet/">kr8 jsonnet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet_render/">kr8 jsonnet render</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 render</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render/">kr8 render</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_helm/">kr8 render helm</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_jsonnet/">kr8 render jsonnet</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Godocs</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-cmd/">kr8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-types/">kr8 types</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">kr8 generate</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#index">Index</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-calculateclustercomponentlist">func CalculateClusterComponentList</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-checkifupdateneeded">func CheckIfUpdateNeeded</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-checkcomponentcache">func CheckcomponentCache</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-cleanoutputdir">func CleanOutputDir</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-cleanupoldcomponentdirs">func CleanupOldComponentDirs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-compileclusterconfiguration">func CompileClusterConfiguration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-createclustergeneratedirs">func CreateClusterGenerateDirs</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-gatherclusterconfig">func GatherClusterConfig</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-genprocesscluster">func GenProcessCluster</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-genprocesscomponent">func GenProcessComponent</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-generatecachefinalizer">func GenerateCacheFinalizer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-generatecacheinitializer">func GenerateCacheInitializer</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-generateincludesfiles">func GenerateIncludesFiles</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-getallclusterparams">func GetAllClusterParams</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-getclustercomponentparamsthreadsafe">func GetClusterComponentParamsThreadsafe</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-getclusterparams">func GetClusterParams</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-getcomponentfiles">func GetComponentFiles</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-getcomponentpath">func GetComponentPath</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-processfile">func ProcessFile</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-rendercomponents">func RenderComponents</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-setupbasecomponentjvm">func SetupBaseComponentJvm</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-setupcomponentvm">func SetupComponentVM</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-setupjvmforcomponent">func SetupJvmForComponent</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-init/">kr8 init</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-jsonnet/">kr8 jsonnet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-util/">kr8 util</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../types/">types</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">kr8+ Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Godocs</li>
      <li class="breadcrumb-item active">kr8 generate</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ice-bergtech/kr8/blob/main/docs/godoc/kr8-generate.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="generate">generate</h1>
<pre><code class="language-go">import &quot;github.com/ice-bergtech/kr8/pkg/generate&quot;
</code></pre>
<p>Package generate implements the logic for generating output files based on input data.</p>
<p>Combines a directory of cluster configurations with a directory of components (along with some Jsonnet libs) to generate output files.</p>
<p>The package prepares a Jsonnet VM and loads the necessary libraries and extvars. A new VM is created for each component.</p>
<h2 id="index">Index</h2>
<ul>
<li><a href="#CalculateClusterComponentList">func CalculateClusterComponentList(clusterComponents map[string]gjson.Result, filters util.PathFilterOptions, existingClusterComponents []string) []string</a></li>
<li><a href="#CheckIfUpdateNeeded">func CheckIfUpdateNeeded(outFile string, outStr string) (bool, error)</a></li>
<li><a href="#CheckcomponentCache">func CheckcomponentCache(cache *kr8_cache.DeploymentCache, compSpec kr8_types.Kr8ComponentSpec, config string, componentName string, logger zerolog.Logger) (bool, *kr8_cache.ComponentCache, error)</a></li>
<li><a href="#CleanOutputDir">func CleanOutputDir(outputFileMap map[string]bool, componentOutputDir string) error</a></li>
<li><a href="#CleanupOldComponentDirs">func CleanupOldComponentDirs(existingComponents []string, clusterComponents map[string]gjson.Result, kr8Spec *kr8_types.Kr8ClusterSpec, logger zerolog.Logger)</a></li>
<li><a href="#CompileClusterConfiguration">func CompileClusterConfiguration(clusterName, clusterDir string, kr8Opts types.Kr8Opts, vmConfig types.VMConfig, generateDirOverride string, logger zerolog.Logger) (*kr8_types.Kr8ClusterSpec, map[string]gjson.Result, error)</a></li>
<li><a href="#CreateClusterGenerateDirs">func CreateClusterGenerateDirs(kr8Spec kr8_types.Kr8ClusterSpec) ([]string, error)</a></li>
<li><a href="#GatherClusterConfig">func GatherClusterConfig(clusterName, clusterDir string, kr8Opts types.Kr8Opts, vmConfig types.VMConfig, generateDirOverride string, filters util.PathFilterOptions, clusterParamsFile string, logger zerolog.Logger) (*kr8_types.Kr8ClusterSpec, []string, string, error)</a></li>
<li><a href="#GenProcessCluster">func GenProcessCluster(clusterName string, clusterdir string, baseDir string, generateDirOverride string, kr8Opts types.Kr8Opts, clusterParamsFile string, filters util.PathFilterOptions, vmConfig types.VMConfig, pool *ants.Pool, enableCache bool, logger zerolog.Logger) error</a></li>
<li><a href="#GenProcessComponent">func GenProcessComponent(vmConfig types.VMConfig, componentName string, kr8Spec kr8_types.Kr8ClusterSpec, kr8Opts types.Kr8Opts, config string, allConfig *safeString, filters util.PathFilterOptions, paramsFile string, cache *kr8_cache.DeploymentCache, logger zerolog.Logger) (*kr8_cache.ComponentCache, error)</a></li>
<li><a href="#GenerateCacheFinalizer">func GenerateCacheFinalizer(enableCache bool, config string, cacheResult map[string]kr8_cache.ComponentCache, cacheFile string, logger zerolog.Logger)</a></li>
<li><a href="#GenerateCacheInitializer">func GenerateCacheInitializer(kr8Spec *kr8_types.Kr8ClusterSpec, enableCache bool, logger zerolog.Logger) (*kr8_cache.DeploymentCache, string)</a></li>
<li><a href="#GenerateIncludesFiles">func GenerateIncludesFiles(includesFiles []kr8_types.Kr8ComponentSpecIncludeObject, kr8Spec kr8_types.Kr8ClusterSpec, kr8Opts types.Kr8Opts, config string, componentName string, compPath string, componentOutputDir string, jvm *jsonnet.VM, logger zerolog.Logger) (map[string]bool, error)</a></li>
<li><a href="#GetAllClusterParams">func GetAllClusterParams(clusterDir string, vmConfig types.VMConfig, jvm *jsonnet.VM, logger zerolog.Logger) error</a></li>
<li><a href="#GetClusterComponentParamsThreadsafe">func GetClusterComponentParamsThreadsafe(allConfig *safeString, config string, vmConfig types.VMConfig, kr8Spec kr8_types.Kr8ClusterSpec, filters util.PathFilterOptions, paramsFile string, jvm *jsonnet.VM, logger zerolog.Logger) error</a></li>
<li><a href="#GetClusterParams">func GetClusterParams(clusterDir string, vmConfig types.VMConfig, logger zerolog.Logger) (map[string]string, error)</a></li>
<li><a href="#GetComponentFiles">func GetComponentFiles(compSpec kr8_types.Kr8ComponentSpec) []string</a></li>
<li><a href="#GetComponentPath">func GetComponentPath(config string, componentName string) string</a></li>
<li><a href="#ProcessFile">func ProcessFile(inputFile string, outputFile string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string, config string, incInfo kr8_types.Kr8ComponentSpecIncludeObject, jvm *jsonnet.VM, logger zerolog.Logger) (string, error)</a></li>
<li><a href="#RenderComponents">func RenderComponents(config string, vmConfig types.VMConfig, kr8Spec kr8_types.Kr8ClusterSpec, compList []string, clusterParamsFile string, pool *ants.Pool, kr8Opts types.Kr8Opts, filters util.PathFilterOptions, cache *kr8_cache.DeploymentCache, logger zerolog.Logger) (map[string]kr8_cache.ComponentCache, error)</a></li>
<li><a href="#SetupBaseComponentJvm">func SetupBaseComponentJvm(vmconfig types.VMConfig, config string, kr8Spec kr8_types.Kr8ClusterSpec) (*jsonnet.VM, error)</a></li>
<li><a href="#SetupComponentVM">func SetupComponentVM(vmConfig types.VMConfig, config string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string, compSpec kr8_types.Kr8ComponentSpec, allConfig *safeString, filters util.PathFilterOptions, paramsFile string, kr8Opts types.Kr8Opts, logger zerolog.Logger) (*jsonnet.VM, string, error)</a></li>
<li><a href="#SetupJvmForComponent">func SetupJvmForComponent(jvm *jsonnet.VM, config string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string)</a></li>
</ul>
<p><a name="CalculateClusterComponentList"></a></p>
<h2 id="func-calculateclustercomponentlist">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L67-L71">CalculateClusterComponentList</a></h2>
<pre><code class="language-go">func CalculateClusterComponentList(clusterComponents map[string]gjson.Result, filters util.PathFilterOptions, existingClusterComponents []string) []string
</code></pre>
<p>Calculates which components should be generated based on filters. Only processes specified component if it's defined in the cluster. Processes components in string sorted order. Sorts out orphaned, generated components directories.</p>
<p><a name="CheckIfUpdateNeeded"></a></p>
<h2 id="func-checkifupdateneeded">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/file_system.go#L71">CheckIfUpdateNeeded</a></h2>
<pre><code class="language-go">func CheckIfUpdateNeeded(outFile string, outStr string) (bool, error)
</code></pre>
<p>Check if a file needs updating based on its current contents and the new contents.</p>
<p><a name="CheckcomponentCache"></a></p>
<h2 id="func-checkcomponentcache">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L160-L166">CheckcomponentCache</a></h2>
<pre><code class="language-go">func CheckcomponentCache(cache *kr8_cache.DeploymentCache, compSpec kr8_types.Kr8ComponentSpec, config string, componentName string, logger zerolog.Logger) (bool, *kr8_cache.ComponentCache, error)
</code></pre>
<p><a name="CleanOutputDir"></a></p>
<h2 id="func-cleanoutputdir">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/file_system.go#L13">CleanOutputDir</a></h2>
<pre><code class="language-go">func CleanOutputDir(outputFileMap map[string]bool, componentOutputDir string) error
</code></pre>
<p><a name="CleanupOldComponentDirs"></a></p>
<h2 id="func-cleanupoldcomponentdirs">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L522-L527">CleanupOldComponentDirs</a></h2>
<pre><code class="language-go">func CleanupOldComponentDirs(existingComponents []string, clusterComponents map[string]gjson.Result, kr8Spec *kr8_types.Kr8ClusterSpec, logger zerolog.Logger)
</code></pre>
<p><a name="CompileClusterConfiguration"></a></p>
<h2 id="func-compileclusterconfiguration">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L545-L551">CompileClusterConfiguration</a></h2>
<pre><code class="language-go">func CompileClusterConfiguration(clusterName, clusterDir string, kr8Opts types.Kr8Opts, vmConfig types.VMConfig, generateDirOverride string, logger zerolog.Logger) (*kr8_types.Kr8ClusterSpec, map[string]gjson.Result, error)
</code></pre>
<p>Build the list of cluster parameter files to combine by walking folder tree leaf to root.</p>
<p><a name="CreateClusterGenerateDirs"></a></p>
<h2 id="func-createclustergeneratedirs">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/file_system.go#L45">CreateClusterGenerateDirs</a></h2>
<pre><code class="language-go">func CreateClusterGenerateDirs(kr8Spec kr8_types.Kr8ClusterSpec) ([]string, error)
</code></pre>
<p>Create the root cluster output directory. Returns a list of cluster component output directories that already existed.</p>
<p><a name="GatherClusterConfig"></a></p>
<h2 id="func-gatherclusterconfig">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L434-L442">GatherClusterConfig</a></h2>
<pre><code class="language-go">func GatherClusterConfig(clusterName, clusterDir string, kr8Opts types.Kr8Opts, vmConfig types.VMConfig, generateDirOverride string, filters util.PathFilterOptions, clusterParamsFile string, logger zerolog.Logger) (*kr8_types.Kr8ClusterSpec, []string, string, error)
</code></pre>
<p><a name="GenProcessCluster"></a></p>
<h2 id="func-genprocesscluster">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L380-L392">GenProcessCluster</a></h2>
<pre><code class="language-go">func GenProcessCluster(clusterName string, clusterdir string, baseDir string, generateDirOverride string, kr8Opts types.Kr8Opts, clusterParamsFile string, filters util.PathFilterOptions, vmConfig types.VMConfig, pool *ants.Pool, enableCache bool, logger zerolog.Logger) error
</code></pre>
<p>The root function for generating a cluster. Prepares and builds the cluster config. Build and processes the list of components.</p>
<p><a name="GenProcessComponent"></a></p>
<h2 id="func-genprocesscomponent">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L95-L106">GenProcessComponent</a></h2>
<pre><code class="language-go">func GenProcessComponent(vmConfig types.VMConfig, componentName string, kr8Spec kr8_types.Kr8ClusterSpec, kr8Opts types.Kr8Opts, config string, allConfig *safeString, filters util.PathFilterOptions, paramsFile string, cache *kr8_cache.DeploymentCache, logger zerolog.Logger) (*kr8_cache.ComponentCache, error)
</code></pre>
<p>Root function for processing a kr8 component. Processes a component through a jsonnet VM to generate output files.</p>
<p><a name="GenerateCacheFinalizer"></a></p>
<h2 id="func-generatecachefinalizer">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L501-L507">GenerateCacheFinalizer</a></h2>
<pre><code class="language-go">func GenerateCacheFinalizer(enableCache bool, config string, cacheResult map[string]kr8_cache.ComponentCache, cacheFile string, logger zerolog.Logger)
</code></pre>
<p><a name="GenerateCacheInitializer"></a></p>
<h2 id="func-generatecacheinitializer">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L481-L485">GenerateCacheInitializer</a></h2>
<pre><code class="language-go">func GenerateCacheInitializer(kr8Spec *kr8_types.Kr8ClusterSpec, enableCache bool, logger zerolog.Logger) (*kr8_cache.DeploymentCache, string)
</code></pre>
<p><a name="GenerateIncludesFiles"></a></p>
<h2 id="func-generateincludesfiles">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L332-L342">GenerateIncludesFiles</a></h2>
<pre><code class="language-go">func GenerateIncludesFiles(includesFiles []kr8_types.Kr8ComponentSpecIncludeObject, kr8Spec kr8_types.Kr8ClusterSpec, kr8Opts types.Kr8Opts, config string, componentName string, compPath string, componentOutputDir string, jvm *jsonnet.VM, logger zerolog.Logger) (map[string]bool, error)
</code></pre>
<p>Generates the list of includes files for a component. Processes each includes file using the component's config. Returns an error if there's an issue with ANY includes file.</p>
<p><a name="GetAllClusterParams"></a></p>
<h2 id="func-getallclusterparams">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L276">GetAllClusterParams</a></h2>
<pre><code class="language-go">func GetAllClusterParams(clusterDir string, vmConfig types.VMConfig, jvm *jsonnet.VM, logger zerolog.Logger) error
</code></pre>
<p>Combine all the cluster params into a single object indexed by cluster name.</p>
<p><a name="GetClusterComponentParamsThreadsafe"></a></p>
<h2 id="func-getclustercomponentparamsthreadsafe">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L293-L302">GetClusterComponentParamsThreadsafe</a></h2>
<pre><code class="language-go">func GetClusterComponentParamsThreadsafe(allConfig *safeString, config string, vmConfig types.VMConfig, kr8Spec kr8_types.Kr8ClusterSpec, filters util.PathFilterOptions, paramsFile string, jvm *jsonnet.VM, logger zerolog.Logger) error
</code></pre>
<p>Include full render of all component params for cluster. Only do this if we have not already cached it and don't already have it stored.</p>
<p><a name="GetClusterParams"></a></p>
<h2 id="func-getclusterparams">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L44">GetClusterParams</a></h2>
<pre><code class="language-go">func GetClusterParams(clusterDir string, vmConfig types.VMConfig, logger zerolog.Logger) (map[string]string, error)
</code></pre>
<p><a name="GetComponentFiles"></a></p>
<h2 id="func-getcomponentfiles">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L186">GetComponentFiles</a></h2>
<pre><code class="language-go">func GetComponentFiles(compSpec kr8_types.Kr8ComponentSpec) []string
</code></pre>
<p><a name="GetComponentPath"></a></p>
<h2 id="func-getcomponentpath">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L271">GetComponentPath</a></h2>
<pre><code class="language-go">func GetComponentPath(config string, componentName string) string
</code></pre>
<p><a name="ProcessFile"></a></p>
<h2 id="func-processfile">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/file_processing.go#L74-L83">ProcessFile</a></h2>
<pre><code class="language-go">func ProcessFile(inputFile string, outputFile string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string, config string, incInfo kr8_types.Kr8ComponentSpecIncludeObject, jvm *jsonnet.VM, logger zerolog.Logger) (string, error)
</code></pre>
<p>Process an includes file. Based on the extension, the file is processed differently.</p>
<ul>
<li>.jsonnet: Imported and processed using jsonnet VM.</li>
<li>.yml, .yaml: Imported and processed through native function ParseYaml.</li>
<li>.tpl, .tmpl: Processed using component config and Sprig templating.</li>
</ul>
<p><a name="RenderComponents"></a></p>
<h2 id="func-rendercomponents">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L590-L601">RenderComponents</a></h2>
<pre><code class="language-go">func RenderComponents(config string, vmConfig types.VMConfig, kr8Spec kr8_types.Kr8ClusterSpec, compList []string, clusterParamsFile string, pool *ants.Pool, kr8Opts types.Kr8Opts, filters util.PathFilterOptions, cache *kr8_cache.DeploymentCache, logger zerolog.Logger) (map[string]kr8_cache.ComponentCache, error)
</code></pre>
<p>Renders a list of components with a given Kr8ClusterSpec configuration. Each component is processed by a process thread from a thread pool.</p>
<p><a name="SetupBaseComponentJvm"></a></p>
<h2 id="func-setupbasecomponentjvm">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/vm_helpers.go#L37-L41">SetupBaseComponentJvm</a></h2>
<pre><code class="language-go">func SetupBaseComponentJvm(vmconfig types.VMConfig, config string, kr8Spec kr8_types.Kr8ClusterSpec) (*jsonnet.VM, error)
</code></pre>
<p>This function sets up the JVM for a given component. It registers native functions, sets up post-processing, and prunes parameters as required. It's faster to create this VM for each component, rather than re-use. Default postprocessor just copies input to output.</p>
<p><a name="SetupComponentVM"></a></p>
<h2 id="func-setupcomponentvm">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/generate.go#L214-L225">SetupComponentVM</a></h2>
<pre><code class="language-go">func SetupComponentVM(vmConfig types.VMConfig, config string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string, compSpec kr8_types.Kr8ComponentSpec, allConfig *safeString, filters util.PathFilterOptions, paramsFile string, kr8Opts types.Kr8Opts, logger zerolog.Logger) (*jsonnet.VM, string, error)
</code></pre>
<p>Setup and configures a jsonnet VM for processing kr8 resources. Creates a new VM and does the following:</p>
<ul>
<li>loads cluster and component config</li>
<li>loads jsonnet library files</li>
<li>loads external file references</li>
</ul>
<p><a name="SetupJvmForComponent"></a></p>
<h2 id="func-setupjvmforcomponent">func <a href="https://github.com:icebergtech/kr8/blob/main/pkg/generate/vm_helpers.go#L19-L24">SetupJvmForComponent</a></h2>
<pre><code class="language-go">func SetupJvmForComponent(jvm *jsonnet.VM, config string, kr8Spec kr8_types.Kr8ClusterSpec, componentName string)
</code></pre>
<p>This function sets up component-specific external code in the JVM. It makes the component config available to the jvm under the `kr8` extVar.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../kr8-types/" class="btn btn-neutral float-left" title="kr8 types"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../kr8-init/" class="btn btn-neutral float-right" title="kr8 init">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ice-bergtech/kr8/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../kr8-types/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../kr8-init/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
