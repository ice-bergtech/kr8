<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Iceberg Tech" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>kr8-cmd - kr8+ Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "kr8-cmd";
        var mkdocs_page_input_path = "godoc/kr8-cmd.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> kr8+ Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/ice-bergtech/kr8-examples">Examples ðŸ”—</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Concepts</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/clusters/">Clusters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../concepts/nativefuncs/">Native Funcs</a>
                  </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../helpers/">Helpers</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Cmd Docs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8/">kr8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_version/">kr8 version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_generate/">kr8 generate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_format/">kr8 format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 get</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get/">kr8 get</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_clusters/">kr8 get clusters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_components/">kr8 get components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_params/">kr8 get params</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 init</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init/">kr8 init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_cluster/">kr8 init cluster</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_component/">kr8 init component</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_repo/">kr8 init repo</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 jsonnet</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet/">kr8 jsonnet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet_render/">kr8 jsonnet render</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 render</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render/">kr8 render</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_helm/">kr8 render helm</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_jsonnet/">kr8 render jsonnet</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Godocs</span></p>
              <ul class="current">
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">kr8-cmd</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#index">Index</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#variables">Variables</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-configurelogger">func ConfigureLogger</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-execute">func Execute</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-generatecommand">func GenerateCommand</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#func-initconfig">func InitConfig</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#type-cmdgenerateoptions">type CmdGenerateOptions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#type-cmdgetoptions">type CmdGetOptions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#type-cmdrenderoptions">type CmdRenderOptions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#type-cmdrootoptions">type CmdRootOptions</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#type-stamp">type Stamp</a>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-generate/">kr8-generate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-init/">kr8-init</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-jsonnet/">kr8-jsonnet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-types/">kr8-types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../kr8-util/">kr8-util</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">kr8+ Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Godocs</li>
      <li class="breadcrumb-item active">kr8-cmd</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ice-bergtech/kr8/blob/main/docs/godoc/kr8-cmd.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="cmd">cmd</h1>
<pre><code class="language-go">import &quot;github.com/ice-bergtech/kr8/cmd&quot;
</code></pre>
<h2 id="index">Index</h2>
<ul>
<li><a href="#variables">Variables</a></li>
<li><a href="#ConfigureLogger">func ConfigureLogger(debug bool)</a></li>
<li><a href="#Execute">func Execute(ver string)</a></li>
<li><a href="#GenerateCommand">func GenerateCommand(cmd *cobra.Command, args []string)</a></li>
<li><a href="#InitConfig">func InitConfig()</a></li>
<li><a href="#CmdGenerateOptions">type CmdGenerateOptions</a></li>
<li><a href="#CmdGetOptions">type CmdGetOptions</a></li>
<li><a href="#CmdRenderOptions">type CmdRenderOptions</a></li>
<li><a href="#CmdRootOptions">type CmdRootOptions</a></li>
<li><a href="#Stamp">type Stamp</a></li>
</ul>
<h2 id="variables">Variables</h2>
<p><a name="FormatCmd"></a></p>
<pre><code class="language-go">var FormatCmd = &amp;cobra.Command{
    Use:   &quot;format [flags]&quot;,
    Short: &quot;Format jsonnet files&quot;,
    Long:  `Format jsonnet configuration files`,

    Args: cobra.MinimumNArgs(0),
    Run: func(cmd *cobra.Command, args []string) {
        // First get a list of all files in the base directory and subdirectories. Ignore .git directories.
        var fileList []string
        err := filepath.Walk(RootConfig.BaseDir, func(path string, info fs.FileInfo, err error) error {
            if info.IsDir() {
                if info.Name() == &quot;.git&quot; {
                    return filepath.SkipDir
                }

                return nil
            }
            fileList = append(fileList, path)

            return nil
        })
        util.FatalErrorCheck(&quot;Error walking the path &quot;+RootConfig.BaseDir, err)

        fileList = util.Filter(fileList, func(s string) bool {
            var result bool
            for _, f := range strings.Split(cmdFormatFlags.Includes, &quot;,&quot;) {
                t, _ := filepath.Match(f, s)
                if t {
                    return t
                }
                result = result || t
            }

            return result
        })

        fileList = util.Filter(fileList, func(s string) bool {
            var result bool
            for _, f := range strings.Split(cmdFormatFlags.Excludes, &quot;,&quot;) {
                t, _ := filepath.Match(f, s)
                if t {
                    return !t
                }
                result = result || t
            }

            return !result
        })
        log.Debug().Msg(&quot;Filtered file list: &quot; + fmt.Sprintf(&quot;%v&quot;, fileList))
        log.Debug().Msg(&quot;Formatting files...&quot;)

        var waitGroup sync.WaitGroup
        parallel, err := cmd.Flags().GetInt(&quot;parallel&quot;)
        util.FatalErrorCheck(&quot;Error getting parallel flag&quot;, err)
        log.Debug().Msg(&quot;Parallel set to &quot; + strconv.Itoa(parallel))
        ants_file, _ := ants.NewPool(parallel)
        for _, filename := range fileList {
            waitGroup.Add(1)
            _ = ants_file.Submit(func() {
                defer waitGroup.Done()
                var bytes []byte
                bytes, err = os.ReadFile(filepath.Clean(filename))
                output, err := formatter.Format(filename, string(bytes), util.GetDefaultFormatOptions())
                if err != nil {
                    fmt.Fprintln(os.Stderr, err.Error())

                    return
                }
                err = os.WriteFile(filepath.Clean(filename), []byte(output), 0600)
                if err != nil {
                    fmt.Fprintln(os.Stderr, err.Error())

                    return
                }
            })
        }
        waitGroup.Wait()
    },
}
</code></pre>
<p><a name="GenerateCmd"></a></p>
<pre><code class="language-go">var GenerateCmd = &amp;cobra.Command{
    Use:     &quot;generate [flags]&quot;,
    Aliases: []string{&quot;gen&quot;},
    Short:   &quot;Generate components&quot;,
    Long:    `Generate components in clusters`,
    Example: &quot;kr8 generate&quot;,

    Args: cobra.MinimumNArgs(0),
    Run:  GenerateCommand,
}
</code></pre>
<p><a name="GetClustersCmd"></a></p>
<pre><code class="language-go">var GetClustersCmd = &amp;cobra.Command{
    Use:   &quot;clusters [flags]&quot;,
    Short: &quot;Get all clusters&quot;,
    Long:  &quot;Get all clusters defined in kr8 config hierarchy&quot;,
    Run: func(cmd *cobra.Command, args []string) {

        clusters, err := util.GetClusterFilenames(RootConfig.ClusterDir)
        util.FatalErrorCheck(&quot;Error getting clusters&quot;, err)

        if cmdGetFlags.NoTable {
            for _, c := range clusters {
                println(c.Name + &quot;: &quot; + c.Path)
            }

            return
        }

        var entry []string
        table := tablewriter.NewWriter(os.Stdout)
        table.SetHeader([]string{&quot;Name&quot;, &quot;Path&quot;})

        for _, c := range clusters {
            entry = append(entry, c.Name)
            entry = append(entry, c.Path)
            table.Append(entry)
            entry = entry[:0]
        }
        table.Render()

    },
}
</code></pre>
<p><a name="GetCmd"></a>GetCmd represents the get command.</p>
<pre><code class="language-go">var GetCmd = &amp;cobra.Command{
    Use:   &quot;get&quot;,
    Short: &quot;Display one or many kr8 resources&quot;,
    Long:  `Displays information about kr8 resources such as clusters and components`,
}
</code></pre>
<p><a name="GetComponentsCmd"></a></p>
<pre><code class="language-go">var GetComponentsCmd = &amp;cobra.Command{
    Use:   &quot;components [flags]&quot;,
    Short: &quot;Get all components&quot;,
    Long:  &quot;Get all available components defined in the kr8 config hierarchy&quot;,
    Run: func(cmd *cobra.Command, args []string) {

        if cmdGetFlags.Cluster == &quot;&quot; &amp;&amp; cmdGetFlags.ClusterParams == &quot;&quot; {
            log.Fatal().Msg(&quot;Please specify a --cluster name and/or --clusterparams file&quot;)
        }

        var params []string
        if cmdGetFlags.Cluster != &quot;&quot; {
            clusterPath, err := util.GetClusterPaths(RootConfig.ClusterDir, cmdGetFlags.Cluster)
            util.FatalErrorCheck(&quot;error getting cluster path for &quot;+cmdGetFlags.Cluster, err)
            params = util.GetClusterParamsFilenames(RootConfig.ClusterDir, clusterPath)
        }
        if cmdGetFlags.ClusterParams != &quot;&quot; {
            params = append(params, cmdGetFlags.ClusterParams)
        }

        jvm, err := jnetvm.JsonnetRenderFiles(RootConfig.VMConfig, params, &quot;._components&quot;, true, &quot;&quot;, &quot;components&quot;)
        util.FatalErrorCheck(&quot;error rendering jsonnet files&quot;, err)
        if cmdGetFlags.ParamField != &quot;&quot; {
            value := gjson.Get(jvm, cmdGetFlags.ParamField)
            if value.String() == &quot;&quot; {
                log.Fatal().Msg(&quot;Error getting param: &quot; + cmdGetFlags.ParamField)
            } else {
                formatted, err := util.Pretty(jvm, RootConfig.Color)
                util.FatalErrorCheck(&quot;error pretty printing jsonnet&quot;, err)
                fmt.Println(formatted)
            }
        } else {
            formatted, err := util.Pretty(jvm, RootConfig.Color)
            util.FatalErrorCheck(&quot;error pretty printing jsonnet&quot;, err)
            fmt.Println(formatted)
        }
    },
}
</code></pre>
<p><a name="GetParamsCmd"></a></p>
<pre><code class="language-go">var GetParamsCmd = &amp;cobra.Command{
    Use:   &quot;params [flags]&quot;,
    Short: &quot;Get parameter for components and clusters&quot;,
    Long:  &quot;Get parameters assigned to clusters and components in the kr8 config hierarchy&quot;,
    Run: func(cmd *cobra.Command, args []string) {
        if cmdGetFlags.Cluster == &quot;&quot; {
            log.Fatal().Msg(&quot;Please specify a --cluster&quot;)
        }

        var cList []string
        if cmdGetFlags.Component != &quot;&quot; {
            cList = append(cList, cmdGetFlags.Component)
        }

        params, err := jnetvm.JsonnetRenderClusterParams(
            RootConfig.VMConfig,
            cmdGetFlags.Cluster,
            cList,
            cmdGetFlags.ClusterParams,
            true,
        )
        util.FatalErrorCheck(&quot;error rendering cluster params&quot;, err)

        if cmdGetFlags.ParamField == &quot;&quot; {
            if cmdGetFlags.Component != &quot;&quot; {
                result := gjson.Get(params, cmdGetFlags.Component).String()
                formatted, err := util.Pretty(result, RootConfig.Color)
                util.FatalErrorCheck(&quot;error pretty printing jsonnet&quot;, err)
                fmt.Println(formatted)
            } else {
                formatted, err := util.Pretty(params, RootConfig.Color)
                util.FatalErrorCheck(&quot;error pretty printing jsonnet&quot;, err)
                fmt.Println(formatted)
            }

            return
        }

        if cmdGetFlags.ParamField != &quot;&quot; {
            value := gjson.Get(params, cmdGetFlags.ParamField)
            if value.String() == &quot;&quot; {
                log.Fatal().Msg(&quot;Error getting param: &quot; + cmdGetFlags.ParamField)
            }

            fmt.Println(value)
        }
    },
}
</code></pre>
<p><a name="InitClusterCmd"></a></p>
<pre><code class="language-go">var InitClusterCmd = &amp;cobra.Command{
    Use:   &quot;cluster [flags]&quot;,
    Short: &quot;Init a new cluster config file&quot;,
    Long:  &quot;Initialize a new cluster configuration file&quot;,
    Run: func(cmd *cobra.Command, args []string) {
        cSpec := types.Kr8ClusterSpec{
            Name:               cmdInitFlags.ClusterName,
            PostProcessor:      &quot;function(input) input&quot;,
            GenerateDir:        &quot;generated&quot;,
            GenerateShortNames: false,
            PruneParams:        false,
            ClusterDir:         RootConfig.ClusterDir,
        }

        if cmdInitFlags.Interactive {
            prompt := &amp;survey.Input{
                Message: &quot;Set the cluster name&quot;,
                Default: cmdInitFlags.ClusterName,
                Help:    &quot;Distinct name for the cluster&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid cluster name&quot;, survey.AskOne(prompt, &amp;cSpec.Name))

            prompt = &amp;survey.Input{
                Message: &quot;Set the cluster configuration directory&quot;,
                Default: RootConfig.ClusterDir,
                Help:    &quot;Set the root directory for the new cluster&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid cluster directory&quot;, survey.AskOne(prompt, &amp;cSpec.ClusterDir))

            promptB := &amp;survey.Confirm{
                Message: &quot;Generate short names for output file names?&quot;,
                Default: cSpec.GenerateShortNames,
                Help:    &quot;Shortens component names and file structure&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid option&quot;, survey.AskOne(promptB, &amp;cSpec.GenerateShortNames))

            promptB = &amp;survey.Confirm{
                Message: &quot;Prune component parameters?&quot;,
                Default: cSpec.PruneParams,
                Help:    &quot;This removes empty and null parameters from configuration&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid option&quot;, survey.AskOne(promptB, &amp;cSpec.PruneParams))
        }

        util.FatalErrorCheck(&quot;Error generating cluster jsonnet file&quot;, kr8init.GenerateClusterJsonnet(cSpec, cSpec.ClusterDir))
    },
}
</code></pre>
<p><a name="InitCmd"></a>InitCmd represents the command. Various subcommands are available to initialize different components of kr8.</p>
<pre><code class="language-go">var InitCmd = &amp;cobra.Command{
    Use:   &quot;init&quot;,
    Short: &quot;Initialize kr8 config repos, components and clusters&quot;,
    Long: `kr8 requires specific directories and exists for its config to work.
This init command helps in creating directory structure for repos, clusters and 
components`,
}
</code></pre>
<p><a name="InitComponentCmd"></a></p>
<pre><code class="language-go">var InitComponentCmd = &amp;cobra.Command{
    Use:   &quot;component [flags]&quot;,
    Short: &quot;Init a new component config file&quot;,
    Long:  &quot;Initialize a new component configuration file&quot;,
    Run: func(cmd *cobra.Command, args []string) {

        if cmdInitFlags.Interactive {
            prompt := &amp;survey.Input{
                Message: &quot;Enter component name&quot;,
                Default: cmdInitFlags.ComponentName,
                Help:    &quot;Enter the name of the component you want to create&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid component name&quot;, survey.AskOne(prompt, &amp;cmdInitFlags.ComponentName))

            prompt = &amp;survey.Input{
                Message: &quot;Enter component directory&quot;,
                Default: RootConfig.ComponentDir,
                Help:    &quot;Enter the directory where you want to create the component&quot;,
            }
            util.FatalErrorCheck(&quot;Invalid component directory&quot;, survey.AskOne(prompt, &amp;RootConfig.ComponentDir))

            promptS := &amp;survey.Select{
                Message: &quot;Select component type&quot;,
                Options: []string{&quot;jsonnet&quot;, &quot;yml&quot;, &quot;tpl&quot;, &quot;chart&quot;},
                Help:    &quot;Select the type of component you want to create&quot;,
                Default: &quot;jsonnet&quot;,
                Description: func(value string, index int) string {
                    switch value {
                    case &quot;jsonnet&quot;:
                        return &quot;Use a Jsonnet file to describe the component resources&quot;
                    case &quot;yml&quot;:
                        return &quot;Use a yml (docker-compose) file to describe the component resources&quot;
                    case &quot;tpl&quot;:
                        return &quot;Use a template file to describe the component resources&quot;
                    case &quot;chart&quot;:
                        return &quot;Use a Helm chart to describe the component resources&quot;
                    default:
                        return &quot;&quot;
                    }
                },
            }
            util.FatalErrorCheck(&quot;Invalid component type&quot;, survey.AskOne(promptS, &amp;cmdInitFlags.ComponentType))
        }
        util.FatalErrorCheck(
            &quot;Error generating component jsonnet&quot;,
            kr8init.GenerateComponentJsonnet(cmdInitFlags, RootConfig.ComponentDir),
        )
    },
}
</code></pre>
<p><a name="InitRepoCmd"></a>Initializes a new kr8 configuration repository</p>
<p>Directory tree:</p>
<pre><code>components/

clusters/

lib/

generated/
</code></pre>
<pre><code class="language-go">var InitRepoCmd = &amp;cobra.Command{
    Use:   &quot;repo [flags] dir&quot;,
    Args:  cobra.MinimumNArgs(1),
    Short: &quot;Initialize a new kr8 config repo&quot;,
    Long: `Initialize a new kr8 config repo by downloading the kr8 config skeleton repo
and initialize a git repo so you can get started`,
    Run: func(cmd *cobra.Command, args []string) {
        if len(args) == 0 {
            log.Fatal().Msg(&quot;Error: no directory specified&quot;)
        }
        outDir := args[len(args)-1]
        log.Debug().Msg(&quot;Initializing kr8 config repo in &quot; + outDir)
        if cmdInitFlags.InitUrl != &quot;&quot; {
            util.FatalErrorCheck(
                &quot;Issue fetching repo&quot;,
                util.FetchRepoUrl(cmdInitFlags.InitUrl, outDir, !cmdInitFlags.Fetch),
            )

            return
        }

        cmdInitOptions := kr8init.Kr8InitOptions{
            InitUrl:       cmdInitFlags.InitUrl,
            ClusterName:   cmdInitFlags.ClusterName,
            ComponentName: &quot;example-component&quot;,
            ComponentType: &quot;jsonnet&quot;,
            Interactive:   false,
            Fetch:         false,
        }
        clusterOptions := types.Kr8ClusterSpec{
            Name:               cmdInitFlags.ClusterName,
            PostProcessor:      &quot;&quot;,
            GenerateDir:        &quot;generated&quot;,
            GenerateShortNames: false,
            PruneParams:        false,
            ClusterDir:         &quot;clusters&quot;,
        }

        util.FatalErrorCheck(
            &quot;Issue creating cluster.jsonnet&quot;,
            kr8init.GenerateClusterJsonnet(clusterOptions, outDir+&quot;/clusters&quot;),
        )
        util.FatalErrorCheck(
            &quot;Issue creating example component.jsonnet&quot;,
            kr8init.GenerateComponentJsonnet(cmdInitOptions, outDir+&quot;/components&quot;),
        )
        util.FatalErrorCheck(
            &quot;Issue creating lib folder&quot;,
            kr8init.GenerateLib(cmdInitFlags.Fetch, outDir+&quot;/lib&quot;),
        )
        util.FatalErrorCheck(
            &quot;Issue creating Readme.md&quot;,
            kr8init.GenerateReadme(outDir, cmdInitOptions, clusterOptions),
        )
    },
}
</code></pre>
<p><a name="JsonnetCmd"></a></p>
<pre><code class="language-go">var JsonnetCmd = &amp;cobra.Command{
    Use:   &quot;jsonnet&quot;,
    Short: &quot;Jsonnet utilities&quot;,
    Long:  `Utility commands to process jsonnet`,
}
</code></pre>
<p><a name="JsonnetRenderCmd"></a></p>
<pre><code class="language-go">var JsonnetRenderCmd = &amp;cobra.Command{
    Use:   &quot;render [flags] file [file ...]&quot;,
    Short: &quot;Render a jsonnet file&quot;,
    Long:  `Render a jsonnet file to JSON or YAML`,

    Args: cobra.MinimumNArgs(1),
    Run: func(cmd *cobra.Command, args []string) {
        for _, f := range args {
            err := jvm.JsonnetRender(cmdFlagsJsonnet, f, RootConfig.VMConfig)
            if err != nil {
                log.Fatal().Str(&quot;file&quot;, f).Err(err).Msg(&quot;error rendering jsonnet file&quot;)
            }
        }
    },
}
</code></pre>
<p><a name="RenderCmd"></a></p>
<pre><code class="language-go">var RenderCmd = &amp;cobra.Command{
    Use:   &quot;render&quot;,
    Short: &quot;Render files&quot;,
    Long:  `Render files in jsonnet or YAML`,
}
</code></pre>
<p><a name="RenderHelmCmd"></a></p>
<pre><code class="language-go">var RenderHelmCmd = &amp;cobra.Command{
    Use:   &quot;helm&quot;,
    Short: &quot;Clean YAML stream from Helm Template output - Reads from Stdin&quot;,
    Long:  `Removes Null YAML objects from a YAML stream`,
    Run: func(cmd *cobra.Command, args []string) {
        decoder := yaml.NewYAMLReader(bufio.NewReader(os.Stdin))
        jsa := [][]byte{}
        for {
            bytes, err := decoder.Read()
            if errors.Is(err, io.EOF) {
                break
            } else if err != nil {
                util.FatalErrorCheck(&quot;Error decoding yaml stream&quot;, err)
            }
            if len(bytes) == 0 {
                continue
            }
            jsonData, err := yaml.ToJSON(bytes)
            util.FatalErrorCheck(&quot;Error converting yaml to JSON&quot;, err)
            if string(jsonData) == &quot;null&quot; {

                continue
            }
            _, _, err = unstructured.UnstructuredJSONScheme.Decode(jsonData, nil, nil)
            util.FatalErrorCheck(&quot;Error handling unstructured JSON&quot;, err)
            jsa = append(jsa, jsonData)
        }
        for _, j := range jsa {
            out, err := goyaml.JSONToYAML(j)
            util.FatalErrorCheck(&quot;Error encoding JSON to YAML&quot;, err)
            fmt.Println(&quot;---&quot;)
            fmt.Println(string(out))
        }
    },
}
</code></pre>
<p><a name="RenderJsonnetCmd"></a></p>
<pre><code class="language-go">var RenderJsonnetCmd = &amp;cobra.Command{
    Use:   &quot;jsonnet file [file ...]&quot;,
    Short: &quot;Render a jsonnet file&quot;,
    Long:  `Render a jsonnet file to JSON or YAML`,

    Args: cobra.MinimumNArgs(1),
    Run: func(cmd *cobra.Command, args []string) {
        for _, fileName := range args {
            err := jvm.JsonnetRender(
                types.CmdJsonnetOptions{
                    Prune:         cmdRenderFlags.Prune,
                    ClusterParams: cmdRenderFlags.ClusterParams,
                    Cluster:       cmdRenderFlags.Cluster,
                    Component:     cmdRenderFlags.ComponentName,
                    Format:        cmdRenderFlags.Format,
                    Color:         false,
                }, fileName, RootConfig.VMConfig)
            if err != nil {
                log.Fatal().Str(&quot;filename&quot;, fileName).Err(err).Msg(&quot;error rendering jsonnet&quot;)
            }
        }
    },
}
</code></pre>
<p><a name="RootCmd"></a>RootCmd represents the base command when called without any subcommands.</p>
<pre><code class="language-go">var RootCmd = &amp;cobra.Command{
    Use:   &quot;kr8&quot;,
    Short: &quot;Kubernetes config parameter framework&quot;,
    Long: `A tool to generate Kubernetes configuration from a hierarchy
    of jsonnet files`,
}
</code></pre>
<p><a name="VersionCmd"></a>Print out versions of packages in use. Chore() - Updated manually.</p>
<pre><code class="language-go">var VersionCmd = &amp;cobra.Command{
    Use:   &quot;version&quot;,
    Short: &quot;Return the current version of kr8+&quot;,
    Long:  `return the current version of kr8+`,
    Run: func(cmd *cobra.Command, args []string) {
        fmt.Println(RootCmd.Use + &quot;+ Version: &quot; + version)
        info, ok := debug.ReadBuildInfo()
        if !ok {
            log.Fatal().Msg(&quot;could not read build info&quot;)
        }
        stamp := retrieveStamp(info)
        fmt.Printf(&quot;  Built with %s on %s\n&quot;, stamp.InfoGoCompiler, stamp.InfoBuildTime)
        fmt.Printf(&quot;  VCS revision: %s\n&quot;, stamp.VCSRevision)
        fmt.Printf(&quot;  Go version %s, GOOS %s, GOARCH %s\n&quot;, info.GoVersion, stamp.InfoGOOS, stamp.InfoGOARCH)
        fmt.Print(&quot;  Dependencies:\n&quot;)
        for _, mod := range retrieveDepends(info) {
            fmt.Printf(&quot;    %s\n&quot;, mod)
        }

    },
}
</code></pre>
<p><a name="ConfigureLogger"></a></p>
<h2 id="func-configurelogger">func <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/root.go#L98">ConfigureLogger</a></h2>
<pre><code class="language-go">func ConfigureLogger(debug bool)
</code></pre>
<p><a name="Execute"></a></p>
<h2 id="func-execute">func <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/root.go#L33">Execute</a></h2>
<pre><code class="language-go">func Execute(ver string)
</code></pre>
<p>Execute adds all child commands to the root command sets flags appropriately. This is called by main.main(). It only needs to happen once to the rootCmd.</p>
<p><a name="GenerateCommand"></a></p>
<h2 id="func-generatecommand">func <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/generate.go#L65">GenerateCommand</a></h2>
<pre><code class="language-go">func GenerateCommand(cmd *cobra.Command, args []string)
</code></pre>
<p>This function will generate the components for each cluster in parallel. It uses a wait group to ensure that all clusters have been processed before exiting.</p>
<p><a name="InitConfig"></a></p>
<h2 id="func-initconfig">func <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/root.go#L137">InitConfig</a></h2>
<pre><code class="language-go">func InitConfig()
</code></pre>
<p>InitConfig reads in config file and ENV variables if set.</p>
<p><a name="CmdGenerateOptions"></a></p>
<h2 id="type-cmdgenerateoptions">type <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/generate.go#L18-L25">CmdGenerateOptions</a></h2>
<p>Stores the options for the 'generate' command.</p>
<pre><code class="language-go">type CmdGenerateOptions struct {
    // Stores the path to the cluster params file
    ClusterParamsFile string
    // Stores the output directory for generated files
    GenerateDir string
    // Stores the filters to apply to clusters and components when generating files
    Filters util.PathFilterOptions
}
</code></pre>
<p><a name="CmdGetOptions"></a></p>
<h2 id="type-cmdgetoptions">type <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/get.go#L38-L52">CmdGetOptions</a></h2>
<p>Holds the options for the get command.</p>
<pre><code class="language-go">type CmdGetOptions struct {
    // ClusterParams provides a way to provide cluster params as a single file.
    // This can be combined with --cluster to override the cluster.
    ClusterParams string
    // If true, just prints result instead of placing in table
    NoTable bool
    // Field to display from the resource
    FieldName string
    // Cluster to get resources from
    Cluster string
    // Component to get resources from
    Component string
    // Param to display from the resource
    ParamField string
}
</code></pre>
<p><a name="CmdRenderOptions"></a></p>
<h2 id="type-cmdrenderoptions">type <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/render.go#L24-L35">CmdRenderOptions</a></h2>
<p>Contains parameters for the kr8 render command.</p>
<pre><code class="language-go">type CmdRenderOptions struct {
    // Prune null and empty objects from rendered json
    Prune bool
    // Filename to read cluster configuration from
    ClusterParams string
    // Name of the component to render
    ComponentName string
    // Name of the cluster to render
    Cluster string
    // Format of the output (yaml, json or stream)
    Format string
}
</code></pre>
<p><a name="CmdRootOptions"></a></p>
<h2 id="type-cmdrootoptions">type <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/root.go#L42-L61">CmdRootOptions</a></h2>
<p>Default options that are available to all commands.</p>
<pre><code class="language-go">type CmdRootOptions struct {
    // kr8 config base directory
    BaseDir string
    // kr8 cluster directory
    ClusterDir string
    // kr8 component directory
    ComponentDir string
    // A config file with kr8 configuration
    ConfigFile string
    // parallelism - defaults to runtime.GOMAXPROCS(0)
    Parallel int
    // log more information about what kr8 is doing. Overrides --loglevel
    Debug bool
    // set log level
    LogLevel string
    // enable colorized output (default true). Set to false to disable&quot;)
    Color bool
    // contains ingormation to configure jsonnet vm
    VMConfig types.VMConfig
}
</code></pre>
<p><a name="RootConfig"></a></p>
<pre><code class="language-go">var RootConfig CmdRootOptions
</code></pre>
<p><a name="Stamp"></a></p>
<h2 id="type-stamp">type <a href="https://github.com/ice-bergtech/kr8/blob/main/cmd/version.go#L13-L20">Stamp</a></h2>
<pre><code class="language-go">type Stamp struct {
    InfoGoVersion  string
    InfoGoCompiler string
    InfoGOARCH     string
    InfoGOOS       string
    InfoBuildTime  string
    VCSRevision    string
}
</code></pre>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../../cmd/kr8_render_jsonnet/" class="btn btn-neutral float-left" title="kr8 render jsonnet"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../kr8-generate/" class="btn btn-neutral float-right" title="kr8-generate">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ice-bergtech/kr8/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../../cmd/kr8_render_jsonnet/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../kr8-generate/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
