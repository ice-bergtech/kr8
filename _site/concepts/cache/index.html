<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="author" content="Iceberg Tech" />
      <link rel="shortcut icon" href="../../img/favicon.ico" />
    <title>kr8+ Generate Caching - kr8+ Docs</title>
    <link rel="stylesheet" href="../../css/theme.css" />
    <link rel="stylesheet" href="../../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "kr8+ Generate Caching";
        var mkdocs_page_input_path = "concepts/cache.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href="../.." class="icon icon-home"> kr8+ Docs
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../..">Home</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../README-repo/">Repo Readme</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="../../installation/">Installation</a>
                </li>
              </ul>
              <ul>
                <li class="toctree-l1"><a class="" href="https://github.com/ice-bergtech/kr8-examples">Examples ðŸ”—</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Concepts</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../overview/">Overview</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../clusters/">Clusters</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../components/">Components</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../nativefuncs/">Native Funcs</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">kr8+ Generate Caching</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#configuration">Configuration</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#operation">Operation</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#1-library-folders">1 Library Folders</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#2-cluster-config">2 Cluster Config</a>
    </li>
    <li class="toctree-l3"><a class="reference internal" href="#3-cluster-component-config-and-component-files">3 Cluster-Component Config and Component Files</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Json Schemas</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../schemas/kr8-plus-cluster-schema.json">Cluster</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../schemas/kr8-plus-component-schema.json">Component</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Cmd Docs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8/">kr8</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_version/">kr8 version</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_generate/">kr8 generate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../cmd/kr8_format/">kr8 format</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 get</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get/">kr8 get</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_clusters/">kr8 get clusters</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_components/">kr8 get components</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_get_params/">kr8 get params</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 init</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init/">kr8 init</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_cluster/">kr8 init cluster</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_component/">kr8 init component</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_init_repo/">kr8 init repo</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 jsonnet</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet/">kr8 jsonnet</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_jsonnet_render/">kr8 jsonnet render</a>
                </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" >kr8 render</a>
    <ul>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render/">kr8 render</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_helm/">kr8 render helm</a>
                </li>
                <li class="toctree-l2"><a class="reference internal" href="../../cmd/kr8_render_jsonnet/">kr8 render jsonnet</a>
                </li>
    </ul>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Godocs</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-cmd/">kr8+</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-types/">kr8+ types</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-generate/">kr8+ generate</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-cache/">kr8+ generate caching</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-native-functions/">kr8+ Jsonnet Native Functions</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-init/">kr8+ init</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-jsonnet/">kr8+ jsonnet</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/kr8-util/">kr8+ util</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../../godoc/types/">types</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../..">kr8+ Docs</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../.." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Concepts</li>
      <li class="breadcrumb-item active">kr8+ Generate Caching</li>
    <li class="wy-breadcrumbs-aside">
          <a href="https://github.com/ice-bergtech/kr8/blob/main/docs/concepts/cache.md" class="icon icon-github"> Edit on GitHub</a>
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="kr8-generate-caching">kr8+ Generate Caching</h1>
<h2 id="configuration">Configuration</h2>
<p>Caching is configured at the cluster <code>_kr8_spec</code> level:</p>
<pre><code class="language-yaml">_kr8_spec+: {
    cache_enable: true, # default false
    cache_compress: true, # default true
}
</code></pre>
<p>If <code>cache_enable</code> is true, the cache file <code>.kr8_cache</code> will be generated and stored within the cluster's <code>generated</code> folder.
The cache is a json file containing base64-encoded information about the cluster.
When <code>cache_compress</code> is enabled, it is stored gzip'd, <strong>greatly</strong> reducing size.</p>
<p>The data structures for the caching functionality are described in <a href="../../godoc/kr8-cache/">godoc/kr8-cache.md</a>.</p>
<h2 id="operation">Operation</h2>
<p>Cache is created by storing kr8+ configuration in a json file on a per-cluster bases.</p>
<p>The cache contains information about the cluster, components, and jsonnet library folders.
Components and clusters will no be generated if their current configuration matches what is stored in the cache file.</p>
<h3 id="1-library-folders">1 Library Folders</h3>
<p>If list of jsonnet library folders or files change, all clusters will be generated.</p>
<h3 id="2-cluster-config">2 Cluster Config</h3>
<p>Next cluster-level configuration is checked.
This includes:</p>
<ul>
<li>Cluster <code>_kr8_spec</code> object</li>
<li>Cluster <code>_cluster</code> object</li>
</ul>
<p>If either of these differ from the cache, all components for that cluster will be generated.</p>
<h3 id="3-cluster-component-config-and-component-files">3 Cluster-Component Config and Component Files</h3>
<p>Component-level caching is performed by:</p>
<ul>
<li>comparing the cluster-level component config for the component</li>
<li>hashing all files in the component directory</li>
</ul>
<p>If the configuration of the component hasn't changed and the files within the component's direcrory haven't changed, then it is skipped.</p>
<p>It does not account for files that a component references that are outside the component's root directory.</p>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../nativefuncs/" class="btn btn-neutral float-left" title="Native Funcs"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../../schemas/kr8-plus-cluster-schema.json" class="btn btn-neutral float-right" title="Cluster">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
        <span>
          <a href="https://github.com/ice-bergtech/kr8/" class="fa fa-github" style="color: #fcfcfc"> GitHub</a>
        </span>
    
    
      <span><a href="../nativefuncs/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../../schemas/kr8-plus-cluster-schema.json" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "../..";</script>
    <script src="../../js/theme_extra.js"></script>
    <script src="../../js/theme.js"></script>
      <script src="../../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
